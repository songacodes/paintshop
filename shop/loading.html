<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Loading...</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      background-color: #ffffff;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      font-family: 'Inter', sans-serif;
    }

    svg {
      width: 3.25em;
      transform-origin: center;
      animation: rotate4 2s linear infinite;
    }

    circle {
      fill: none;
      stroke: hsl(234, 100%, 66%);
      stroke-width: 2;
      stroke-dasharray: 1, 200;
      stroke-dashoffset: 0;
      stroke-linecap: round;
      animation: dash4 1.5s ease-in-out infinite;
    }

    @keyframes rotate4 {
      100% {
        transform: rotate(360deg);
      }
    }

    @keyframes dash4 {
      0% {
        stroke-dasharray: 1, 200;
        stroke-dashoffset: 0;
      }
      50% {
        stroke-dasharray: 90, 200;
        stroke-dashoffset: -35px;
      }
      100% {
        stroke-dashoffset: -125px;
      }
    }

    p {
      margin-top: 1rem;
      font-weight: 500;
      color: #333;
      font-size: 16px;
    }
  </style>
</head>
<body>

  <svg viewBox="25 25 50 50">
    <circle cx="50" cy="50" r="20"></circle>
  </svg>
  <p id="loading-text">Loading...</p>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const logoutMessage = sessionStorage.getItem('logoutMessage');
      const user = JSON.parse(sessionStorage.getItem('loggedInUser'));
      const loadingText = document.getElementById('loading-text');
      setTimeout(function() {
        if (logoutMessage) {
          loadingText.textContent = logoutMessage;
          sessionStorage.removeItem('logoutMessage');
          setTimeout(() => { window.location.href = 'login.html'; }, 1200);
        } else if (!user) {
          loadingText.textContent = 'Session expired. Please log in again.';
          setTimeout(() => { window.location.href = 'login.html'; }, 1200);
        } else if (user.role === 'superadmin') {
            window.location.href = 'super-admin.html';
        } else if (user.role === 'master-admin') {
            window.location.href = 'master-admin.html';
        } else if (user.role === 'admin') {
          window.location.href = 'shopmanager-decision.html';
        } else if (user.role === 'branch') {
            window.location.href = 'purchase-form.html';
        } else {
          loadingText.textContent = 'Session expired. Please log in again.';
          setTimeout(() => { window.location.href = 'login.html'; }, 1200);
      }
      }, 1200);
    });
  </script>

</body>
</html>
